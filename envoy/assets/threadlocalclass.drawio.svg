<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1081px" height="871px" viewBox="-0.5 -0.5 1081 871" content="&lt;mxfile host=&quot;97423c5a-fcee-4114-88dc-81d8398cfa01&quot; modified=&quot;2020-12-03T03:06:55.802Z&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Code/1.51.1 Chrome/83.0.4103.122 Electron/9.3.3 Safari/537.36&quot; etag=&quot;HyrmuDc76nJpkuOi7o7N&quot; version=&quot;12.2.4&quot; pages=&quot;1&quot;&gt;&lt;diagram id=&quot;fyQS8TKatzoOjtdmcGir&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;"><defs><clipPath id="mx-clip-69-261-302-26-0"><rect x="69" y="261" width="302" height="26"/></clipPath><clipPath id="mx-clip-69-287-302-26-0"><rect x="69" y="287" width="302" height="26"/></clipPath><clipPath id="mx-clip-69-321-302-26-0"><rect x="69" y="321" width="302" height="26"/></clipPath><clipPath id="mx-clip-69-347-302-28-0"><rect x="69" y="347" width="302" height="28"/></clipPath><clipPath id="mx-clip-69-375-302-28-0"><rect x="69" y="375" width="302" height="28"/></clipPath><clipPath id="mx-clip-69-403-302-28-0"><rect x="69" y="403" width="302" height="28"/></clipPath><clipPath id="mx-clip-544-261-482-26-0"><rect x="544" y="261" width="482" height="26"/></clipPath><clipPath id="mx-clip-544-287-482-26-0"><rect x="544" y="287" width="482" height="26"/></clipPath><clipPath id="mx-clip-544-313-482-26-0"><rect x="544" y="313" width="482" height="26"/></clipPath><clipPath id="mx-clip-544-339-482-26-0"><rect x="544" y="339" width="482" height="26"/></clipPath><clipPath id="mx-clip-544-373-482-26-0"><rect x="544" y="373" width="482" height="26"/></clipPath><clipPath id="mx-clip-544-399-482-26-0"><rect x="544" y="399" width="482" height="26"/></clipPath><clipPath id="mx-clip-544-425-482-26-0"><rect x="544" y="425" width="482" height="26"/></clipPath><clipPath id="mx-clip-544-451-482-26-0"><rect x="544" y="451" width="482" height="26"/></clipPath><clipPath id="mx-clip-544-477-482-26-0"><rect x="544" y="477" width="482" height="26"/></clipPath><clipPath id="mx-clip-544-503-482-26-0"><rect x="544" y="503" width="482" height="26"/></clipPath><clipPath id="mx-clip-70-597-322-26-0"><rect x="70" y="597" width="322" height="26"/></clipPath><clipPath id="mx-clip-70-623-322-26-0"><rect x="70" y="623" width="322" height="26"/></clipPath><clipPath id="mx-clip-109-99-222-26-0"><rect x="109" y="99" width="222" height="26"/></clipPath><clipPath id="mx-clip-704-49-152-26-0"><rect x="704" y="49" width="152" height="26"/></clipPath><clipPath id="mx-clip-524-709-252-26-0"><rect x="524" y="709" width="252" height="26"/></clipPath></defs><g><path d="M 65 256 L 65 230 L 375 230 L 375 256" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 65 256 L 65 426 L 375 426 L 375 256" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 65 256 L 375 256" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px"><text x="219.5" y="248.5">SlotImpl</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-69-261-302-26-0)" font-size="12px"><text x="70.5" y="273.5">+ parent_:InstanceImpl</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-69-287-302-26-0)" font-size="12px"><text x="70.5" y="299.5">+ index_: const uint32_t</text></g><path d="M 65 312 L 375 312" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-69-321-302-26-0)" font-size="12px"><text x="70.5" y="333.5">+ set(InitializeCb): void</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-69-347-302-28-0)" font-size="12px"><text x="70.5" y="359.5">+ get(InitializeCb): ThreadLocalObjectSharedPtr</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-69-375-302-28-0)" font-size="12px"><text x="70.5" y="387.5">+ runOnAllThreads(UpdateCb): void</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-69-403-302-28-0)" font-size="12px"><text x="70.5" y="415.5">+ runOnAllThreads(UpdateCb, Event::PostCb):void</text></g><path d="M 220 230 L 220 134.12" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 220 121.12 L 226.5 134.12 L 213.5 134.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 390 327.64 L 537.76 328.99" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="383" cy="327.57" rx="7" ry="7" fill="none" stroke="#000000" pointer-events="none"/><path d="M 376 327.51 L 390 327.64 M 383.06 320.57 L 382.94 334.57" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 529.84 333.42 L 538.88 329 L 529.92 324.42" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 540 256 L 540 230 L 1030 230 L 1030 256" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 540 256 L 540 524 L 1030 524 L 1030 256" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 540 256 L 1030 256" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px"><text x="784.5" y="248.5">Envoy::ThreadLocal::InstanceImpl</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-544-261-482-26-0)" font-size="12px"><text x="545.5" y="273.5">-  slots_:std::vector&lt;Slot*&gt;</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-544-287-482-26-0)" font-size="12px"><text x="545.5" y="299.5">- free_slot_indexes_:std::list&lt;uint32_t&gt;</text></g><g fill="#FF0000" font-family="Helvetica" font-weight="bold" clip-path="url(#mx-clip-544-313-482-26-0)" font-size="12px"><text x="545.5" y="325.5">- thread_local_data_:static thread_local ThreadLocalData</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-544-339-482-26-0)" font-size="12px"><text x="545.5" y="351.5">- registered_threads_:std::list&lt;std::reference_wrapper&lt;Event::Dispatcher&gt;&gt;</text></g><path d="M 540 364 L 1030 364" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-544-373-482-26-0)" font-size="12px"><text x="545.5" y="385.5">+ allocateSlot():SlotPtr</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-544-399-482-26-0)" font-size="12px"><text x="545.5" y="411.5">+ registerThread(Event::Dispatcher, bool):void</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-544-425-482-26-0)" font-size="12px"><text x="545.5" y="437.5">- removeSlot(uint32_t ): void</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-544-451-482-26-0)" font-size="12px"><text x="545.5" y="463.5">- runOnAllThreads(Event::PostCb):void</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-544-477-482-26-0)" font-size="12px"><text x="545.5" y="489.5">- runOnAllThreads(Event::PostCb, Event::PostCb main_callback):void </text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-544-503-482-26-0)" font-size="12px"><text x="545.5" y="515.5">- setThreadLocal(uint32_t index, ThreadLocalObjectSharedPtr object ): static void</text></g><path d="M 66 592 L 66 566 L 396 566 L 396 592" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 66 592 L 66 644 L 396 644 L 396 592" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 66 592 L 396 592" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="230.5" y="583.5">ThreadLocalData</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-70-597-322-26-0)" font-size="12px"><text x="71.5" y="609.5">+ dispatcher_:Event::Dispatcher</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-70-623-322-26-0)" font-size="12px"><text x="71.5" y="635.5">+ data_:std::vector&lt;ThreadLocalObjectSharedPtr&gt;</text></g><path d="M 224 549 L 224 490 Q 224 480 234 480 L 410 480 Q 420 480 420 470 L 420 357 Q 420 347 430 347 L 537.76 347" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="224" cy="556" rx="7" ry="7" fill="none" stroke="#000000" pointer-events="none"/><path d="M 224 563 L 224 549 M 217 556 L 231 556" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 529.88 351.5 L 538.88 347 L 529.88 342.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 940 120 L 1066 120 L 1080 134 L 1080 190 L 940 190 L 940 120 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1066 120 L 1066 134 L 1080 134" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(942.5,121.5)"><foreignObject style="overflow:visible;" pointer-events="none" width="136" height="40"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 136px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">这是线程本地存储TLS，每个线程都有一份自己的存储区</div></div></foreignObject></g><path d="M 105 86 L 105 60 L 335 60 L 335 86" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 105 86 L 105 120 L 335 120 L 335 86" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 105 86 L 335 86" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px"><text x="219.5" y="78.5">Slot</text></g><path d="M 105 90 L 335 90" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-109-99-222-26-0)" font-size="12px"><text x="110.5" y="111.5">+getTyped:template &lt;class T&gt; T&amp;</text></g><path d="M 700 36 L 700 10 L 860 10 L 860 36" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 700 36 L 700 70 L 860 70 L 860 36" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 700 36 L 860 36" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px"><text x="779.5" y="28.5">SlotAllocator</text></g><path d="M 700 40 L 860 40" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-704-49-152-26-0)" font-size="12px"><text x="705.5" y="61.5">+ allocateSlot:SlotPtr</text></g><path d="M 785 230 L 783.21 84.12" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 783.05 71.12 L 789.71 84.04 L 776.71 84.2 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 520 696 L 520 670 L 780 670 L 780 696" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 520 696 L 520 730 L 780 730 L 780 696" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 520 696 L 780 696" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px"><text x="649.5" y="688.5">ThreadLocalObject</text></g><path d="M 520 700 L 780 700" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-524-709-252-26-0)" font-size="12px"><text x="525.5" y="721.5">+ asType: template &lt;class T&gt; T&amp;</text></g><path d="M 860 574 L 1016 574 L 1030 588 L 1030 644 L 860 644 L 860 574 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1016 574 L 1016 588 L 1030 588" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(862.5,575.5)"><foreignObject style="overflow:visible;" pointer-events="none" width="166" height="40"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 166px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">所有需要被threadlocal存储的对象都要集成ThreadLocalObject</div></div></foreignObject></g><path d="M 797.14 308 L 940 155" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 780 685 L 860 609" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 375 0 L 576 0 L 590 14 L 590 90 L 375 90 L 375 0 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 576 0 L 576 14 L 590 14" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(377.5,1.5)"><foreignObject style="overflow:visible;" pointer-events="none" width="211" height="54"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 211px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">所有需要被存储的信息都会被分配一个Slot槽位，作为以后存储数据和获取数据的唯一接口。index_作为索引指示了在每个TLS本地存储的数据的位置</div></div></foreignObject></g><path d="M 220 60 L 376.08 30.96" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 0 730 L 251 730 L 265 744 L 265 870 L 0 870 L 0 730 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 251 730 L 251 744 L 265 744" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(2.5,731.5)"><foreignObject style="overflow:visible;" pointer-events="none" width="261" height="124"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 261px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">线程TLS存储的对象在data_中，data_中具体某一个槽位上实际存储的是一个数据对象的share_ptr的智能指针，也就是说线程之间是共享同一个对象的<br />dispatcher_是每个线程的event_base句柄，slot中runOnAllThreads会向每个线程的dispatcher_中提交任务，每个线程的下次事件循环的时候就会执行这个任务，就可以将ThreadLocalObjectPtr存放到data_中对应的位置上</div></div></foreignObject></g><path d="M 132.5 730 L 186.12 644" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/></g></svg>