<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1081px" height="871px" viewBox="-0.5 -0.5 1081 871" content="&lt;mxfile host=&quot;b5ff7282-86b2-4477-a1dd-fb34e32eb2a3&quot; modified=&quot;2020-12-03T06:15:00.482Z&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Code/1.51.1 Chrome/83.0.4103.122 Electron/9.3.3 Safari/537.36&quot; etag=&quot;_6QrhhWNE45bwv9Idsm4&quot; version=&quot;12.2.4&quot; pages=&quot;1&quot;&gt;&lt;diagram id=&quot;fyQS8TKatzoOjtdmcGir&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;"><defs><clipPath id="mx-clip-69-261-302-26-0"><rect x="69" y="261" width="302" height="26"/></clipPath><clipPath id="mx-clip-69-287-302-26-0"><rect x="69" y="287" width="302" height="26"/></clipPath><clipPath id="mx-clip-69-321-302-26-0"><rect x="69" y="321" width="302" height="26"/></clipPath><clipPath id="mx-clip-69-347-302-28-0"><rect x="69" y="347" width="302" height="28"/></clipPath><clipPath id="mx-clip-69-375-302-28-0"><rect x="69" y="375" width="302" height="28"/></clipPath><clipPath id="mx-clip-69-403-302-28-0"><rect x="69" y="403" width="302" height="28"/></clipPath><clipPath id="mx-clip-544-261-482-26-0"><rect x="544" y="261" width="482" height="26"/></clipPath><clipPath id="mx-clip-544-287-482-26-0"><rect x="544" y="287" width="482" height="26"/></clipPath><clipPath id="mx-clip-544-313-482-26-0"><rect x="544" y="313" width="482" height="26"/></clipPath><clipPath id="mx-clip-544-339-482-26-0"><rect x="544" y="339" width="482" height="26"/></clipPath><clipPath id="mx-clip-544-373-482-26-0"><rect x="544" y="373" width="482" height="26"/></clipPath><clipPath id="mx-clip-544-399-482-26-0"><rect x="544" y="399" width="482" height="26"/></clipPath><clipPath id="mx-clip-544-425-482-26-0"><rect x="544" y="425" width="482" height="26"/></clipPath><clipPath id="mx-clip-544-451-482-26-0"><rect x="544" y="451" width="482" height="26"/></clipPath><clipPath id="mx-clip-544-477-482-26-0"><rect x="544" y="477" width="482" height="26"/></clipPath><clipPath id="mx-clip-544-503-482-26-0"><rect x="544" y="503" width="482" height="26"/></clipPath><clipPath id="mx-clip-70-597-322-26-0"><rect x="70" y="597" width="322" height="26"/></clipPath><clipPath id="mx-clip-70-623-322-26-0"><rect x="70" y="623" width="322" height="26"/></clipPath><clipPath id="mx-clip-109-99-222-26-0"><rect x="109" y="99" width="222" height="26"/></clipPath><clipPath id="mx-clip-704-49-152-26-0"><rect x="704" y="49" width="152" height="26"/></clipPath><clipPath id="mx-clip-524-709-252-26-0"><rect x="524" y="709" width="252" height="26"/></clipPath></defs><g><path d="M 65 256 L 65 230 L 375 230 L 375 256" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 65 256 L 65 426 L 375 426 L 375 256" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 65 256 L 375 256" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px"><text x="219.5" y="248.5">SlotImpl</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-69-261-302-26-0)" font-size="12px"><text x="70.5" y="273.5">+ parent_:InstanceImpl</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-69-287-302-26-0)" font-size="12px"><text x="70.5" y="299.5">+ index_: const uint32_t</text></g><path d="M 65 312 L 375 312" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-69-321-302-26-0)" font-size="12px"><text x="70.5" y="333.5">+ set(InitializeCb): void</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-69-347-302-28-0)" font-size="12px"><text x="70.5" y="359.5">+ get(InitializeCb): ThreadLocalObjectSharedPtr</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-69-375-302-28-0)" font-size="12px"><text x="70.5" y="387.5">+ runOnAllThreads(UpdateCb): void</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-69-403-302-28-0)" font-size="12px"><text x="70.5" y="415.5">+ runOnAllThreads(UpdateCb, Event::PostCb):void</text></g><path d="M 220 230 L 220 134.12" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 220 121.12 L 226.5 134.12 L 213.5 134.12 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 390 327.64 L 537.76 328.99" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="383" cy="327.57" rx="7" ry="7" fill="none" stroke="#000000" pointer-events="none"/><path d="M 376 327.51 L 390 327.64 M 383.06 320.57 L 382.94 334.57" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 529.84 333.42 L 538.88 329 L 529.92 324.42" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 540 256 L 540 230 L 1030 230 L 1030 256" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 540 256 L 540 524 L 1030 524 L 1030 256" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 540 256 L 1030 256" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px"><text x="784.5" y="248.5">Envoy::ThreadLocal::InstanceImpl</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-544-261-482-26-0)" font-size="12px"><text x="545.5" y="273.5">-  slots_:std::vector&lt;Slot*&gt;</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-544-287-482-26-0)" font-size="12px"><text x="545.5" y="299.5">- free_slot_indexes_:std::list&lt;uint32_t&gt;</text></g><g fill="#FF0000" font-family="Helvetica" font-weight="bold" clip-path="url(#mx-clip-544-313-482-26-0)" font-size="12px"><text x="545.5" y="325.5">- thread_local_data_:static thread_local ThreadLocalData</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-544-339-482-26-0)" font-size="12px"><text x="545.5" y="351.5">- registered_threads_:std::list&lt;std::reference_wrapper&lt;Event::Dispatcher&gt;&gt;</text></g><path d="M 540 364 L 1030 364" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-544-373-482-26-0)" font-size="12px"><text x="545.5" y="385.5">+ allocateSlot():SlotPtr</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-544-399-482-26-0)" font-size="12px"><text x="545.5" y="411.5">+ registerThread(Event::Dispatcher, bool):void</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-544-425-482-26-0)" font-size="12px"><text x="545.5" y="437.5">- removeSlot(uint32_t ): void</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-544-451-482-26-0)" font-size="12px"><text x="545.5" y="463.5">- runOnAllThreads(Event::PostCb):void</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-544-477-482-26-0)" font-size="12px"><text x="545.5" y="489.5">- runOnAllThreads(Event::PostCb, Event::PostCb main_callback):void </text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-544-503-482-26-0)" font-size="12px"><text x="545.5" y="515.5">- setThreadLocal(uint32_t index, ThreadLocalObjectSharedPtr object ): static void</text></g><path d="M 66 592 L 66 566 L 396 566 L 396 592" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 66 592 L 66 644 L 396 644 L 396 592" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 66 592 L 396 592" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="230.5" y="583.5">ThreadLocalData</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-70-597-322-26-0)" font-size="12px"><text x="71.5" y="609.5">+ dispatcher_:Event::Dispatcher</text></g><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-70-623-322-26-0)" font-size="12px"><text x="71.5" y="635.5">+ data_:std::vector&lt;ThreadLocalObjectSharedPtr&gt;</text></g><path d="M 224 549 L 224 490 Q 224 480 234 480 L 410 480 Q 420 480 420 470 L 420 357 Q 420 347 430 347 L 537.76 347" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="224" cy="556" rx="7" ry="7" fill="none" stroke="#000000" pointer-events="none"/><path d="M 224 563 L 224 549 M 217 556 L 231 556" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 529.88 351.5 L 538.88 347 L 529.88 342.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 940 120 L 1066 120 L 1080 134 L 1080 190 L 940 190 L 940 120 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1066 120 L 1066 134 L 1080 134" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(942.5,121.5)"><foreignObject style="overflow:visible;" pointer-events="none" width="136" height="40"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 136px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">这是线程本地存储TLS，每个线程都有一份自己的存储区</div></div></foreignObject></g><path d="M 105 86 L 105 60 L 335 60 L 335 86" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 105 86 L 105 120 L 335 120 L 335 86" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 105 86 L 335 86" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px"><text x="219.5" y="78.5">Slot</text></g><path d="M 105 90 L 335 90" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-109-99-222-26-0)" font-size="12px"><text x="110.5" y="111.5">+getTyped:template &lt;class T&gt; T&amp;</text></g><path d="M 700 36 L 700 10 L 860 10 L 860 36" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 700 36 L 700 70 L 860 70 L 860 36" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 700 36 L 860 36" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px"><text x="779.5" y="28.5">SlotAllocator</text></g><path d="M 700 40 L 860 40" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-704-49-152-26-0)" font-size="12px"><text x="705.5" y="61.5">+ allocateSlot:SlotPtr</text></g><path d="M 785 230 L 783.21 84.12" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 783.05 71.12 L 789.71 84.04 L 776.71 84.2 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 520 696 L 520 670 L 780 670 L 780 696" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 520 696 L 520 730 L 780 730 L 780 696" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 520 696 L 780 696" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px"><text x="649.5" y="688.5">ThreadLocalObject</text></g><path d="M 520 700 L 780 700" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-524-709-252-26-0)" font-size="12px"><text x="525.5" y="721.5">+ asType: template &lt;class T&gt; T&amp;</text></g><path d="M 860 574 L 1016 574 L 1030 588 L 1030 644 L 860 644 L 860 574 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1016 574 L 1016 588 L 1030 588" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(862.5,575.5)"><foreignObject style="overflow:visible;" pointer-events="none" width="166" height="40"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 166px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">所有需要被threadlocal存储的对象都要继承ThreadLocalObject基类</div></div></foreignObject></g><path d="M 797.14 308 L 940 155" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 780 685 L 860 609" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 375 0 L 576 0 L 590 14 L 590 90 L 375 90 L 375 0 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 576 0 L 576 14 L 590 14" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(377.5,1.5)"><foreignObject style="overflow:visible;" pointer-events="none" width="211" height="54"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 211px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">所有需要被存储的信息都会被分配一个Slot槽位，作为以后存储数据和获取数据的唯一接口。index_作为索引指示了在每个TLS本地存储的数据的位置</div></div></foreignObject></g><path d="M 220 60 L 376.08 30.96" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 0 730 L 251 730 L 265 744 L 265 870 L 0 870 L 0 730 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 251 730 L 251 744 L 265 744" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(2.5,731.5)"><foreignObject style="overflow:visible;" pointer-events="none" width="261" height="124"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 261px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">线程TLS存储的对象在data_中，data_中具体某一个槽位上实际存储的是一个数据对象的share_ptr的智能指针，也就是说线程之间是共享同一个对象的<br />dispatcher_是每个线程的event_base句柄，slot中runOnAllThreads会向每个线程的dispatcher_中提交任务，每个线程的下次事件循环的时候就会执行这个任务，就可以将ThreadLocalObjectPtr存放到data_中对应的位置上</div></div></foreignObject></g><path d="M 132.5 730 L 186.12 644" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/></g></svg>